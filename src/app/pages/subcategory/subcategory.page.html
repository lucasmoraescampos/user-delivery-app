<ion-header mode="ios" class="ion-no-border">

  <ion-toolbar>

    <ion-buttons slot="start">

      <ion-back-button text=""></ion-back-button>

    </ion-buttons>

    <ion-title *ngIf="subcategory">

      {{ subcategory.name }}

    </ion-title>

  </ion-toolbar>

  <ion-toolbar mode="md">

    <ion-segment [value]="segment" (ionChange)="segmentChanged($event)">

      <ion-segment-button value="1">

        <ion-label>Lojas ({{ companies.length }})</ion-label>

      </ion-segment-button>

      <ion-segment-button value="2">

        <ion-label>Itens ({{ products.length }})</ion-label>

      </ion-segment-button>

    </ion-segment>

  </ion-toolbar>

</ion-header>

<ion-content class="ion-padding-top">

  <ion-refresher mode="md" slot="fixed" (ionRefresh)="refresh($event)">

    <ion-refresher-content></ion-refresher-content>

  </ion-refresher>

  <ion-grid class="ion-no-padding" mode="ios">

    <ion-row class="companies" *ngIf="segment == 1">

      <ion-col size="12" *ngFor="let c of companies">

        <ion-card class="ion-no-margin animated bounceInUp" button="true" (click)="company(c)">

          <ion-card-content class="ion-no-padding">

            <ion-row>

              <div [ngClass]="{ 'image': true, 'close': !c.is_open }">

                <ion-img [src]="c.photo"></ion-img>

                <h6 [hidden]="c.is_open">Fechado</h6>

              </div>

              <div class="info">

                <h6>{{ c.name }}</h6>

                <p>

                  <span class="new" *ngIf="c.feedback == null">Novo</span>

                  <span class="stars" *ngIf="c.feedback != null">

                    <ion-icon name="star"></ion-icon> {{ c.feedback }}

                  </span>

                  <ion-icon class="ellipse" name="ellipse"></ion-icon>

                  {{ c.waiting_time }}

                  <ion-icon class="ellipse" name="ellipse"></ion-icon>

                  {{ c.distance | distance }}

                </p>

                <p>

                  Entrega

                  <span class="price" *ngIf="c.delivery_price != null">{{ c.delivery_price | money }}</span>

                  <span class="price" *ngIf="c.delivery_price == null">Grátis</span>

                </p>

              </div>

            </ion-row>

          </ion-card-content>

        </ion-card>

      </ion-col>

    </ion-row>

    <ion-row class="items" *ngIf="segment == 2">

      <ion-col size="6" *ngFor="let p of products">

        <ion-card class="ion-no-margin animated bounceInUp" button="true" (click)="product(p)">

          <ion-card-header class="ion-no-padding">

            <ion-img [src]="p.photo"></ion-img>

            <ion-thumbnail>
              <img [src]="p.company_photo">
            </ion-thumbnail>

          </ion-card-header>

          <ion-card-content class="ion-text-left">

            <h6 class="ion-text-wrap">{{ p.name }}</h6>

            <p class="ion-text-wrap description">{{ p.description }}</p>

            <p class="prices">

              <span class="price">{{ p.price | money }}</span>

              <span class="scratched-price" *ngIf="p.promotional_price != null">{{ p.promotional_price | money }}</span>

            </p>

          </ion-card-content>

          <ion-footer class="ion-text-center">

            <span>{{ p.waiting_time }} min</span>

            <ion-icon name="ellipse"></ion-icon>

            <span>{{ p.distance | distance }}</span>

            <br>

            <span>Entrega</span>

            <span class="price" *ngIf="p.delivery_price != null">{{ p.delivery_price | money }}</span>

            <span class="price" *ngIf="p.delivery_price == null">Grátis</span>

          </ion-footer>

        </ion-card>

      </ion-col>

    </ion-row>

  </ion-grid>

</ion-content>

<app-button-cart></app-button-cart>